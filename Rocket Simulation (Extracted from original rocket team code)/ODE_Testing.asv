% This script is to compare ODE solvers using a simplified physics equation
% that omits certain parameters
clc; clear;


%
% wind components (m/s)
%
global windh;
global windv;
windh = 10;
windv = 0;

[t0,y0] = ode45(@rigidbody_ode,[0 10],[0 0 0 0 pi/2 0]);
y0(:,1:4) = y0(:,1:4)/.3048;
y0(:,5:6) = y0(:,5:6)*180/pi;
[apogee0,index0] = max(-y0(:,2));
disp(['Apogee ',num2str(apogee0),' (ft)']);

[t1,y1] = ode23(@rigidbody_ode,[0 10],[0 0 0 0 pi/2 0]);
y1(:,1:4) = y1(:,1:4)/.3048;
y1(:,5:6) = y1(:,5:6)*180/pi;
[apogee1,index1] = max(-y1(:,2));
disp(['Apogee ',num2str(apogee1),' (ft)']);

[t2,y2] = ode113(@rigidbody_ode,[0 10],[0 0 0 0 pi/2 0]);
y2(:,1:4) = y2(:,1:4)/.3048;
y2(:,5:6) = y2(:,5:6)*180/pi;
[apogee2,index2] = max(-y2(:,2));
disp(['Apogee ',num2str(apogee2),' (ft)']);

[t3,y3] = ode15s(@rigidbody_ode,[0 10],[0 0 0 0 pi/2 0]);
y3(:,1:4) = y3(:,1:4)/.3048;
y3(:,5:6) = y3(:,5:6)*180/pi;
[apogee3,index3] = max(-y3(:,2));
disp(['Apogee ',num2str(apogee3),' (ft)']);

[t4,y4] = ode15s(@rigidbody_ode,[0 10],[0 0 0 0 pi/2 0]);
y4(:,1:4) = y4(:,1:4)/.3048;
y4(:,5:6) = y4(:,5:6)*180/pi;
[apogee4,index4] = max(-y4(:,2));
disp(['Apogee ',num2str(apogee4),' (ft)']);

%
% Plot trajectory
%
figure(1)
plot(y0(:,1),-y0(:,2),'k',y1(:,1),-y1(:,2),'r',y2(:,1),-y2(:,2),'b' ...
    ,y3(:,1),-y3(:,2),'g',y4(:,1),-y4(:,2),'p');
xlabel('Downrange (ft)');
ylabel('Altitude (ft)');
legend('ODE45','ODE23','ODE113','ODE15s','ODE23s');

%
% Plot velocity
%
figure(2)
plot(t0,y0(:,3),'k',t1,y1(:,3),'r',t2,y2(:,3),'b' ...
    ,y3(:,1),-y3(:,2),'g',y4(:,1),-y4(:,2),'p');
xlabel('Time (s)');
ylabel('Forward Velocity (m/s)');
legend('ODE45','ODE23','ODE113','ODE15s','ODE23s');
